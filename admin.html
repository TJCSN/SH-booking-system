
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel - Member Management</title>
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}
 
body {
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
min-height: 100vh;
padding: 20px;
}
 
/* Login Screen Styles */
.login-container {
max-width: 450px;
margin: 100px auto;
background: white;
border-radius: 20px;
padding: 40px;
box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
}
 
.login-header {
text-align: center;
margin-bottom: 30px;
}
 
.login-icon {
font-size: 70px;
margin-bottom: 15px;
}
 
.login-title {
color: #333;
font-size: 28px;
margin-bottom: 10px;
}
 
.login-subtitle {
color: #666;
font-size: 14px;
}
 
.login-form {
display: flex;
flex-direction: column;
gap: 20px;
}
 
.form-group-login {
display: flex;
flex-direction: column;
gap: 8px;
}
 
.form-group-login label {
color: #333;
font-weight: bold;
font-size: 14px;
}
 
.form-group-login input {
padding: 15px;
border: 2px solid #ddd;
border-radius: 10px;
font-size: 16px;
transition: all 0.3s;
}
 
.form-group-login input:focus {
outline: none;
border-color: #f5576c;
box-shadow: 0 0 0 3px rgba(245, 87, 108, 0.1);
}
 
.login-btn {
padding: 15px;
background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
color: white;
border: none;
border-radius: 10px;
font-size: 18px;
font-weight: bold;
cursor: pointer;
transition: all 0.3s;
box-shadow: 0 4px 15px rgba(245, 87, 108, 0.4);
}
 
.login-btn:hover {
transform: translateY(-2px);
box-shadow: 0 6px 20px rgba(245, 87, 108, 0.6);
}
 
.login-btn:active {
transform: translateY(0);
}
 
.login-error {
background: #f8d7da;
color: #721c24;
padding: 12px;
border-radius: 8px;
border-left: 4px solid #dc3545;
font-size: 14px;
display: none;
}
 
.login-error.show {
display: block;
animation: shake 0.5s;
}
 
@keyframes shake {
0%, 100% { transform: translateX(0); }
25% { transform: translateX(-10px); }
75% { transform: translateX(10px); }
}
 
.back-link {
text-align: center;
margin-top: 20px;
}
 
.back-link a {
color: #f5576c;
text-decoration: none;
font-weight: bold;
transition: all 0.3s;
}
 
.back-link a:hover {
color: #f093fb;
}
 
/* Main Admin Panel Styles */
.admin-content {
display: none;
}
 
.container {
max-width: 1000px;
margin: 0 auto;
background: white;
border-radius: 20px;
padding: 40px;
box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
}
 
.header {
text-align: center;
margin-bottom: 40px;
padding-bottom: 20px;
border-bottom: 3px solid #f5576c;
position: relative;
}
 
.header-icon {
font-size: 60px;
margin-bottom: 15px;
}
 
h1 {
color: #333;
font-size: 32px;
margin-bottom: 10px;
}
 
.subtitle {
color: #666;
font-size: 16px;
}
 
.logout-btn {
position: absolute;
top: 0;
right: 0;
padding: 10px 20px;
background: #dc3545;
color: white;
border: none;
border-radius: 8px;
font-weight: bold;
cursor: pointer;
transition: all 0.3s;
}
 
.logout-btn:hover {
background: #c82333;
transform: scale(1.05);
}
 
.nav-back {
display: inline-block;
margin-bottom: 20px;
padding: 12px 24px;
background: #6c757d;
color: white;
text-decoration: none;
border-radius: 8px;
font-weight: bold;
transition: all 0.3s;
}
 
.nav-back:hover {
background: #5a6268;
transform: translateX(-5px);
}
 
.stats-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
gap: 20px;
margin-bottom: 40px;
}
 
.stat-card {
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
padding: 25px;
border-radius: 15px;
color: white;
text-align: center;
box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}
 
.stat-number {
font-size: 36px;
font-weight: bold;
margin-bottom: 8px;
}
 
.stat-label {
font-size: 14px;
opacity: 0.9;
}
 
.section {
background: #f8f9fa;
padding: 30px;
border-radius: 15px;
margin-bottom: 30px;
}
 
.section h2 {
color: #333;
margin-bottom: 20px;
font-size: 24px;
display: flex;
align-items: center;
gap: 10px;
}
 
.upload-area {
border: 3px dashed #ddd;
border-radius: 15px;
padding: 40px;
text-align: center;
background: white;
transition: all 0.3s;
cursor: pointer;
}
 
.upload-area:hover {
border-color: #f5576c;
background: #fff5f7;
}
 
.upload-area.dragover {
border-color: #f5576c;
background: #fff5f7;
transform: scale(1.02);
}
 
.upload-icon {
font-size: 60px;
margin-bottom: 15px;
}
 
.upload-text {
font-size: 18px;
color: #333;
margin-bottom: 10px;
font-weight: bold;
}
 
.upload-hint {
font-size: 14px;
color: #666;
margin-bottom: 20px;
}
 
.file-input {
display: none;
}
 
.btn {
padding: 15px 30px;
border: none;
border-radius: 10px;
font-size: 16px;
font-weight: bold;
cursor: pointer;
transition: all 0.3s;
display: inline-block;
}
 
.btn-primary {
background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
color: white;
box-shadow: 0 4px 15px rgba(245, 87, 108, 0.4);
}
 
.btn-primary:hover {
transform: translateY(-2px);
box-shadow: 0 6px 20px rgba(245, 87, 108, 0.6);
}
 
.btn-secondary {
background: #6c757d;
color: white;
}
 
.btn-secondary:hover {
background: #5a6268;
}
 
.btn-danger {
background: #dc3545;
color: white;
}
 
.btn-danger:hover {
background: #c82333;
}
 
.btn-success {
background: #28a745;
color: white;
}
 
.btn-success:hover {
background: #218838;
}
 
.member-list {
background: white;
border-radius: 10px;
padding: 20px;
max-height: 400px;
overflow-y: auto;
}
 
.member-list h3 {
color: #333;
margin-bottom: 15px;
font-size: 18px;
position: sticky;
top: 0;
background: white;
padding-bottom: 10px;
border-bottom: 2px solid #e0e0e0;
}
 
.member-item {
display: flex;
justify-content: space-between;
align-items: center;
padding: 12px 15px;
border-bottom: 1px solid #e0e0e0;
transition: background 0.2s;
}
 
.member-item:hover {
background: #f8f9fa;
}
 
.member-item:last-child {
border-bottom: none;
}
 
.member-name {
font-size: 16px;
color: #333;
display: flex;
align-items: center;
gap: 10px;
}
 
.member-badge {
background: #e3f2fd;
color: #1976d2;
padding: 4px 10px;
border-radius: 12px;
font-size: 12px;
font-weight: bold;
}
 
.delete-btn {
background: #dc3545;
color: white;
border: none;
padding: 8px 15px;
border-radius: 6px;
cursor: pointer;
font-size: 14px;
transition: all 0.3s;
}
 
.delete-btn:hover {
background: #c82333;
transform: scale(1.05);
}
 
.empty-state {
text-align: center;
padding: 40px;
color: #999;
}
 
.empty-state-icon {
font-size: 60px;
margin-bottom: 15px;
}
 
.alert {
padding: 15px 20px;
border-radius: 10px;
margin-bottom: 20px;
display: none;
}
 
.alert.show {
display: block;
animation: slideIn 0.3s ease-out;
}
 
@keyframes slideIn {
from {
opacity: 0;
transform: translateY(-10px);
}
to {
opacity: 1;
transform: translateY(0);
}
}
 
.alert-success {
background: #d4edda;
color: #155724;
border-left: 4px solid #28a745;
}
 
.alert-error {
background: #f8d7da;
color: #721c24;
border-left: 4px solid #dc3545;
}
 
.alert-info {
background: #d1ecf1;
color: #0c5460;
border-left: 4px solid #17a2b8;
}
 
.instructions {
background: #fff3cd;
border-left: 4px solid #ffc107;
padding: 20px;
border-radius: 10px;
margin-bottom: 20px;
}
 
.instructions h3 {
color: #856404;
margin-bottom: 10px;
font-size: 18px;
}
 
.instructions ol {
margin-left: 20px;
color: #856404;
}
 
.instructions li {
margin-bottom: 8px;
line-height: 1.6;
}
 
.action-buttons {
display: flex;
gap: 15px;
flex-wrap: wrap;
margin-top: 20px;
}
 
.sample-download {
background: #17a2b8;
color: white;
padding: 12px 24px;
border-radius: 8px;
text-decoration: none;
display: inline-flex;
align-items: center;
gap: 8px;
font-weight: bold;
transition: all 0.3s;
}
 
.sample-download:hover {
background: #138496;
transform: translateY(-2px);
}
 
@media (max-width: 768px) {
.login-container {
margin: 50px auto;
padding: 30px 20px;
}
 
.container {
padding: 25px 20px;
}
 
h1 {
font-size: 26px;
}
 
.logout-btn {
position: static;
width: 100%;
margin-top: 15px;
}
 
.stats-grid {
grid-template-columns: 1fr;
}
 
.section {
padding: 20px;
}
 
.upload-area {
padding: 30px 20px;
}
 
.action-buttons {
flex-direction: column;
}
 
.btn {
width: 100%;
}
}
</style>
</head>
<body>
 
<!-- Login Screen -->
<div class="login-container" id="loginScreen">
<div class="login-header">
<div class="login-icon">üîê</div>
<h2 class="login-title">Admin Login</h2>
<p class="login-subtitle">Enter password to access admin panel</p>
</div>
 
<form class="login-form" id="loginForm">
<div class="form-group-login">
<label for="adminPassword">Password</label>
<input type="password" id="adminPassword" placeholder="Enter admin password" required autocomplete="current-password">
</div>
 
<div class="login-error" id="loginError">
‚ùå Incorrect password. Please try again.
</div>
 
<button type="submit" class="login-btn">üîì Login</button>
</form>
 
<div class="back-link">
<a href="index.html">‚Üê Back to Home</a>
</div>
</div>
 
<!-- Admin Panel Content -->
<div class="admin-content" id="adminContent">
<div class="container">
<a href="index.html" class="nav-back">‚Üê Back to Home</a>
 
<div class="header">
<button class="logout-btn" onclick="logout()">üö™ Logout</button>
<div class="header-icon">üë•</div>
<h1>Admin Panel</h1>
<p class="subtitle">Manage members and system settings</p>
</div>
 
<div id="alertContainer"></div>
 
<div class="stats-grid">
<div class="stat-card">
<div class="stat-number" id="totalMembers">0</div>
<div class="stat-label">Total Members</div>
</div>
<div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
<div class="stat-number" id="lastUpdated">Never</div>
<div class="stat-label">Last Updated</div>
</div>
</div>
 
<div class="section">
<h2>üì§ Upload Member List</h2>
 
<div class="instructions">
<h3>üìã Instructions:</h3>
<ol>
<li>Prepare an Excel file (.xlsx or .xls) with member names in <strong>Column A</strong></li>
<li>First row can be a header (e.g., "Member Name") - it will be skipped</li>
<li>Each subsequent row should contain one member name</li>
<li>Click the upload area below or drag and drop your file</li>
<li>Members will be automatically imported and saved</li>
</ol>
</div>
 
<div class="upload-area" id="uploadArea">
<div class="upload-icon">üìÅ</div>
<div class="upload-text">Click to upload or drag & drop</div>
<div class="upload-hint">Supports .xlsx and .xls files</div>
<input type="file" id="fileInput" class="file-input" accept=".xlsx,.xls">
</div>
 
<div class="action-buttons">
<button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
üìÇ Choose File
</button>
<a href="#" class="sample-download" onclick="downloadSample(); return false;">
üì• Download Sample Excel
</a>
</div>
</div>
 
<div class="section">
<h2>üë§ Add Member Manually</h2>
<div style="display: flex; gap: 15px; flex-wrap: wrap;">
<input type="text" id="manualMemberName" placeholder="Enter member name"
style="flex: 1; min-width: 200px; padding: 15px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
<button class="btn btn-success" onclick="addMemberManually()">
‚ûï Add Member
</button>
</div>
</div>
 
<div class="section">
<h2>üìã Current Members</h2>
<div class="member-list" id="memberList">
<div class="empty-state">
<div class="empty-state-icon">üì≠</div>
<p>No members yet. Upload an Excel file or add manually.</p>
</div>
</div>
<div class="action-buttons" style="margin-top: 20px;">
<button class="btn btn-danger" onclick="clearAllMembers()">
üóëÔ∏è Clear All Members
</button>
<button class="btn btn-secondary" onclick="exportMembers()">
üíæ Export to Excel
</button>
</div>
</div>
</div>
</div>
 
<!-- Include SheetJS library for Excel processing -->
<script src=https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js></script>
 
<script>
// ============================================
// PASSWORD PROTECTION
// ============================================
const ADMIN_PASSWORD = 'admin123'; // ‚ö†Ô∏è CHANGE THIS PASSWORD!
 
// Check authentication on page load
window.addEventListener('DOMContentLoaded', function() {
    checkAuth();
});
 
function checkAuth() {
    const isAuthenticated = sessionStorage.getItem('adminAuthenticated');
   
    if (isAuthenticated === 'true') {
        showAdminPanel();
    } else {
        showLoginScreen();
    }
}
 
function showLoginScreen() {
    document.getElementById('loginScreen').style.display = 'block';
    document.getElementById('adminContent').style.display = 'none';
}
 
function showAdminPanel() {
    document.getElementById('loginScreen').style.display = 'none';
    document.getElementById('adminContent').style.display = 'block';
   
    // Load admin panel data
    loadMembers();
    updateStats();
    displayMembers();
}
 
// Handle login form submission
document.getElementById('loginForm').addEventListener('submit', function(e) {
    e.preventDefault();
   
    const password = document.getElementById('adminPassword').value;
    const errorDiv = document.getElementById('loginError');
   
    if (password === ADMIN_PASSWORD) {
        // Successful login
        sessionStorage.setItem('adminAuthenticated', 'true');
        errorDiv.classList.remove('show');
        document.getElementById('adminPassword').value = '';
        showAdminPanel();
    } else {
        // Failed login
        errorDiv.classList.add('show');
        document.getElementById('adminPassword').value = '';
        document.getElementById('adminPassword').focus();
       
        // Hide error after 3 seconds
        setTimeout(() => {
            errorDiv.classList.remove('show');
        }, 3000);
    }
});
 
function logout() {
    if (confirm('Are you sure you want to logout?')) {
        sessionStorage.removeItem('adminAuthenticated');
        showLoginScreen();
    }
}
 
// ============================================
// MEMBER MANAGEMENT CODE
// ============================================
let members = [];
 
function loadMembers() {
    const storedMembers = localStorage.getItem('memberList');
    if (storedMembers) {
        try {
            members = JSON.parse(storedMembers);
            console.log('Loaded', members.length, 'members');
        } catch (e) {
            console.error('Error loading members:', e);
            members = [];
        }
    }
}
 
function saveMembers() {
    localStorage.setItem('memberList', JSON.stringify(members));
    localStorage.setItem('memberListUpdated', new Date().toISOString());
    updateStats();
    displayMembers();
}
 
function updateStats() {
    document.getElementById('totalMembers').textContent = members.length;
   
    const lastUpdated = localStorage.getItem('memberListUpdated');
    if (lastUpdated) {
        const date = new Date(lastUpdated);
        document.getElementById('lastUpdated').textContent = date.toLocaleDateString();
    } else {
        document.getElementById('lastUpdated').textContent = 'Never';
    }
}
 
function displayMembers() {
    const memberList = document.getElementById('memberList');
   
    if (members.length === 0) {
        memberList.innerHTML = `
            <div class="empty-state">
                <div class="empty-state-icon">üì≠</div>
                <p>No members yet. Upload an Excel file or add manually.</p>
            </div>
        `;
        return;
    }
   
    const sortedMembers = [...members].sort((a, b) => a.localeCompare(b));
   
    let html = '<h3>üë• Member List (' + members.length + ')</h3>';
    sortedMembers.forEach((member, index) => {
        html += `
            <div class="member-item">
                <div class="member-name">
                    <span class="member-badge">#${index + 1}</span>
                    ${member}
                </div>
                <button class="delete-btn" onclick="deleteMember('${member.replace(/'/g, "\\'")}')">
                    üóëÔ∏è Delete
                </button>
            </div>
        `;
    });
   
    memberList.innerHTML = html;
}
 
function showAlert(message, type = 'success') {
    const alertContainer = document.getElementById('alertContainer');
    const alertDiv = document.createElement('div');
    alertDiv.className = `alert alert-${type}`;
    alertDiv.textContent = message;
   
    alertContainer.innerHTML = '';
    alertContainer.appendChild(alertDiv);
   
    setTimeout(() => alertDiv.classList.add('show'), 10);
   
    setTimeout(() => {
        alertDiv.classList.remove('show');
        setTimeout(() => alertDiv.remove(), 300);
    }, 5000);
}
 
// File upload handling
const uploadArea = document.getElementById('uploadArea');
const fileInput = document.getElementById('fileInput');
 
uploadArea.addEventListener('click', () => fileInput.click());
 
uploadArea.addEventListener('dragover', (e) => {
    e.preventDefault();
    uploadArea.classList.add('dragover');
});
 
uploadArea.addEventListener('dragleave', () => {
    uploadArea.classList.remove('dragover');
});
 
uploadArea.addEventListener('drop', (e) => {
    e.preventDefault();
    uploadArea.classList.remove('dragover');
   
    const files = e.dataTransfer.files;
    if (files.length > 0) {
        handleFile(files[0]);
    }
});
 
fileInput.addEventListener('change', (e) => {
    if (e.target.files.length > 0) {
        handleFile(e.target.files[0]);
    }
});
 
function handleFile(file) {
    const fileName = file.name;
    const fileExtension = fileName.split('.').pop().toLowerCase();
   
    if (fileExtension !== 'xlsx' && fileExtension !== 'xls') {
        showAlert('‚ùå Please upload a valid Excel file (.xlsx or .xls)', 'error');
        return;
    }
   
    const reader = new FileReader();
   
    reader.onload = function(e) {
        try {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, { type: 'array' });
           
            const firstSheetName = workbook.SheetNames[0];
            const worksheet = workbook.Sheets[firstSheetName];
           
            const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
           
            const newMembers = [];
           
            // Skip first row (header) and process the rest
            for (let i = 1; i < jsonData.length; i++) {
                const row = jsonData[i];
                if (row[0] && typeof row[0] === 'string') {
                    const memberName = row[0].trim();
                    if (memberName && !newMembers.includes(memberName)) {
                        newMembers.push(memberName);
                    }
                }
            }
           
            if (newMembers.length === 0) {
                showAlert('‚ö†Ô∏è No valid member names found in the Excel file', 'error');
                return;
            }
           
            // Merge with existing members (avoid duplicates)
            newMembers.forEach(member => {
                if (!members.includes(member)) {
                    members.push(member);
                }
            });
           
            saveMembers();
            showAlert(`‚úÖ Successfully imported ${newMembers.length} members!`, 'success');
           
        } catch (error) {
            console.error('Error processing file:', error);
            showAlert('‚ùå Error processing Excel file. Please check the format.', 'error');
        }
    };
   
    reader.onerror = function() {
        showAlert('‚ùå Error reading file', 'error');
    };
   
    reader.readAsArrayBuffer(file);
    fileInput.value = ''; // Reset input
}
 
function addMemberManually() {
    const input = document.getElementById('manualMemberName');
    const memberName = input.value.trim();
   
    if (!memberName) {
        showAlert('‚ö†Ô∏è Please enter a member name', 'error');
        return;
    }
   
    if (members.includes(memberName)) {
        showAlert('‚ö†Ô∏è This member already exists', 'error');
        return;
    }
   
    members.push(memberName);
    saveMembers();
    input.value = '';
    showAlert(`‚úÖ Added ${memberName} successfully!`, 'success');
}
 
function deleteMember(memberName) {
    if (confirm(`Are you sure you want to delete "${memberName}"?`)) {
        members = members.filter(m => m !== memberName);
        saveMembers();
        showAlert(`‚úÖ Deleted ${memberName}`, 'success');
    }
}
 
function clearAllMembers() {
    if (members.length === 0) {
        showAlert('‚ö†Ô∏è No members to clear', 'info');
        return;
    }
   
    if (confirm(`‚ö†Ô∏è Are you sure you want to delete ALL ${members.length} members? This cannot be undone!`)) {
        members = [];
        saveMembers();
        showAlert('‚úÖ All members have been cleared', 'success');
    }
}
 
function exportMembers() {
    if (members.length === 0) {
        showAlert('‚ö†Ô∏è No members to export', 'info');
        return;
    }
   
    const ws_data = [['Member Name']];
    members.forEach(member => {
        ws_data.push([member]);
    });
   
    const ws = XLSX.utils.aoa_to_sheet(ws_data);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, 'Members');
   
    const fileName = `members_${new Date().toISOString().split('T')[0]}.xlsx`;
    XLSX.writeFile(wb, fileName);
   
    showAlert(`‚úÖ Exported ${members.length} members to ${fileName}`, 'success');
}
 
function downloadSample() {
    const ws_data = [
        ['Member Name'],
        ['Alice Johnson'],
        ['Bob Smith'],
        ['Charlie Brown'],
        ['Diana Prince'],
        ['Eve Anderson']
    ];
   
    const ws = XLSX.utils.aoa_to_sheet(ws_data);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, 'Members');
   
    XLSX.writeFile(wb, 'sample_member_list.xlsx');
    showAlert('‚úÖ Sample Excel file downloaded!', 'success');
}
 
// Allow Enter key to add member
document.getElementById('manualMemberName').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        addMemberManually();
    }
});
</script>
</body>
</html>
